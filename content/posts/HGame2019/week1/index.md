---
title: HGame week1
subtitle: ""
date: 2020-02-01
lastmod: 2020-02-01
draft: false
description: 2020 VidarTeam Hgame Writeup
tags:
    - Writeup
series:
    - HGame
hiddenFromHomePage: false
hiddenFromSearch: false
avatarURL : "favicon.svg"
toc:
  enable: true
math:
  enable: true
lightgallery: false
license: "CC BY-NC-ND"
---
<!-- Main Content -->

<!--more-->

## Misc

### ç­¾åˆ°é¢˜

ç»™äº†ä¸€ä¸²base64ï¼Œè§£ç ä¹‹åŽå¾—åˆ°äº†ä¸€ä¸²æ‘©å°”æ–¯

![](img000.png)

æ‰¾äº†æ‘©å°”æ–¯çš„æ ‘çŠ¶æŸ¥æ‰¾è¡¨

![](img001.png)

æ‹¿åˆ°flag

>hgame{W3LCOME_TO_2020_HGAM3}

---

### å£çº¸

é¦–å…ˆç»™äº†ä¸€ä¸ªåŽ‹ç¼©åŒ…ï¼Œè§£åŽ‹ä¹‹åŽæ˜¯ä¸€å¼ äºŒæ¬¡å…ƒçš„å†™çœŸï¼Œbinwalkçœ‹ä¸€ä¸‹

![](img003.png)

å¯ä»¥çœ‹åˆ°æ˜¯ä¸ªå›¾ç§ï¼Œé‡Œé¢æœ‰ä¸ªçœ‹èµ·æ¥åƒåŠ å¯†è¿‡çš„åŽ‹ç¼©åŒ…ï¼Œæœ‰`flag.txt`è¿˜æœ‰æ³¨é‡Š
WinHexæ‰“å¼€å‘çŽ°jpgæ–‡ä»¶å°¾`FF D9`åŽé¢è·Ÿäº†ä¸€ä¸ªzipçš„æ•°æ®å¤´ï¼Œå‰ªåˆ‡å‡ºæ¥å¾—åˆ°ä¸€ä¸ªçœŸåŠ å¯†çš„åŽ‹ç¼©åŒ…

![](img004.png)

ä¸€å¼€å§‹çœ‹è¿™ä¸ª`Picture ID`æ²¡ä»€ä¹ˆå¤´ç»ªï¼Œidentifyåˆ†æžäº†åŠå¤©ä¹Ÿæ²¡æ‰¾å‡ºè¿™ä¸ªIDæ˜¯ä»€ä¹ˆ
æƒ³åˆ°ä¹‹å‰å›½åº†çš„æ—¶å€™æœ‰é“ç±»ä¼¼çš„é¢˜ç›®æ˜¯æ”¾åˆ°æœç´¢å¼•æ“Žé‡Œæœç´¢ï¼ŒäºŽæ˜¯å°±ç”¨äº†Googleçš„å›¾ç‰‡æœç´¢ï¼Œæ‰¾äº†åŠå¤©å‘çŽ°è¿™å¼ å›¾æºè‡ªPç«™ï¼Œå¹¶ä¸”æ‰¾åˆ°äº†å¯¹åº”çš„ID`76953815`
è¯•ç€å½“ä½œå¯†ç è¾“äº†è¿›åŽ»ï¼ŒæˆåŠŸè§£å¯†
æŠŠé‡Œé¢çš„`flag.txt`è§£åŽ‹å‡ºæ¥ï¼Œå¾—åˆ°äº†ä¸€ä¸²Unicodeå­—ç¬¦ä¸²

![](img005.png)

å†™äº†ä¸ªè½¬æ¢è„šæœ¬ï¼Œæ‹¿åˆ°flag
> hgame{Do_y0u_KnOW_uNiC0d3?}

---

### å…‹è‹é²ç¥žè¯

æ‹¿åˆ°åŽ‹ç¼©åŒ…åŽæ‰“å¼€ï¼Œé‡Œé¢æœ‰ä¸€ä¸ª`bacon.txt`å’Œä¸€ä¸ª`Novel.zip`

![](img006.png)

è§£åŽ‹å‡ºæ¥ï¼Œå‘çŽ°è¿™ä¸ªåŽ‹ç¼©åŒ…æ˜¯ç»è¿‡åŠ å¯†çš„ï¼Œé‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ª`bacon.txt`å’Œä¸€ä¸ªdoc

![](img007.png)

æ‰“å¼€txtå‘çŽ°é‡Œé¢æ˜¯ä¸€æ®µåŸ¹æ ¹å¯†ç 

![](img008.png)

æ‰¾äº†ä¸ªè§£å¯†å·¥å…·ï¼Œæ‹¿åˆ°æ˜Žæ–‡

![](img009.png)

ç”±äºŽæœ‰ä¸¤ä¸ªåç§°ç›¸åŒçš„æ–‡ä»¶ï¼Œæ¯”è¾ƒäº†ä¸€ä¸‹`CRCæ ¡éªŒç `å‘çŽ°ä¸€æ ·ï¼ŒäºŽæ˜¯å°±æƒ³åˆ°äº†[æ˜Žæ–‡æ”»å‡»](https://www.cnblogs.com/ECJTUACM-873284962/p/9387711.html)ï¼ŒæŠŠæ˜Žæ–‡è°ƒå¥½åŽ‹ç¼©ç®—æ³•åŽæ”¾è¿›AAPRé‡Œè·‘æ˜Žæ–‡æ”»å‡»ï¼Œå¾ˆå¿«å°±å¾—å‡ºäº†å¯†é’¥

![](img010.png)

æ‰“å¼€æ–‡æ¡£å‘çŽ°è¿˜æ˜¯è¦å¯†ç ï¼ŒäºŽæ˜¯æƒ³åˆ°ä¹‹å‰æ²¡ç”¨åˆ°çš„å¯†ç ï¼Œæç¤ºè¯´å¯†ç æ˜¯å¤§å†™ï¼ŒäºŽæ˜¯ç”¨äº†å¤§å†™å½¢å¼ï¼Œé¡ºåˆ©æ‰“å¼€ï¼Œå¤§è‡´çœ‹äº†ä¸‹æ˜¯ç¯‡å°è¯´ï¼Œæ²¡æœ‰çœ‹åˆ°flagï¼ŒäºŽæ˜¯è®¾ç½®é‡ŒæŠŠéšè—æ–‡å­—æ‰“å¼€

![](img011.png)

æ‹¿åˆ°flag
> hgame{Y0u_h@Ve_F0Und_mY_S3cRet}

---

### ç­¾åˆ°é¢˜ProPlus

æ‹¿åˆ°åŽ‹ç¼©åŒ…åŽæ‰“å¼€ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªåŠ å¯†çš„åŽ‹ç¼©åŒ…`OK.zip`å’Œ`Password.txt`

![](img012.png)

æ‰“å¼€txtçœ‹äº†ä¸‹ï¼Œå‘çŽ°æœ‰ä¸¤æ®µå¯†ç 

![](img013.png)

ä¸‹é¢hintç»™äº†æ …æ å¯†ç å’Œå‡¯æ’’å¯†ç ï¼Œç„¶åŽè¿™ä¸¤ä¸ªå¯†ç éƒ½éœ€è¦keyæ¥åŠ å¯†ï¼Œåˆšå¥½æœ‰ä¸¤ä¸ªæ•°å­—3å’Œ5ï¼Œ äºŽæ˜¯ç›´æŽ¥æ‹¿åŽ»æ …æ è§£å¯†å’Œå‡¯æ’’ä½ç§»

![](img014.png)

![](img015.png)

ç„¶åŽå†æŠŠè§£å¯†ç»“æžœç›´æŽ¥æ‹¿åŽ»åšå‡¯æ’’ä½ç§»

![](img016.png)

ç¬¦åˆæè¿°ï¼Œä¸€æ®µè‹±æ–‡å¥å­ï¼Œä¸€ä¸ªå¤§å†™å­—æ¯ä¸²(å¯†ç )ï¼Œ ç„¶åŽæŠŠå¾—åˆ°çš„å¤§å†™å­—æ¯ä¸²æ‹¿åŽ»è§£åŽ‹ç¼©åŒ…ï¼ŒæˆåŠŸæ‰“å¼€

![](img017.png)

æ‰“å¼€ä¹‹åŽå‘çŽ°æœ‰å¾ˆå¤šOokï¼Œä½†æ˜¯æ„Ÿè§‰æœ‰ç‚¹ç†Ÿæ‚‰(ä¹‹å‰çœ‹çš„ä¸€ç¯‡ä»‹ç»å„ç§ä¹±ä¸ƒå…«ç³Ÿå¯†ç çš„åšå®¢)ï¼Œç„¶åŽå°±ç¿»äº†ç¿»å‘çŽ°è¿™ä¸ªæ˜¯ä¸€ä¸ªå«ookçš„å¯†ç ï¼Œè€Œä¸”åœ¨åšå®¢é‡Œé¢ä¹Ÿæ‰¾åˆ°äº†å¯¹åº”çš„è§£å¯†å·¥å…·ï¼Œ[è¿™é‡Œæ”¾ä¸€ä¸‹](https://github.com/splitbrain/ook)ä»¥é˜²å¿˜è®°

![](img018.png)

è§£å¯†åŽå‘çŽ°æ˜¯ä¸€æ®µBase32ï¼Œæ ¹æ®å­—æ®µå¤´çœ‹èµ·æ¥è¿™ä¸ªookå¯†æ–‡å¥½åƒä¹Ÿæ˜¯ä»Žè¿™é‡Œç”Ÿæˆçš„233

![](img019.png)

ç„¶åŽæ‹¿åŽ»åœ¨çº¿Base32è½¬ç ï¼Œåˆå¾—åˆ°äº†ä¸€æ®µBase64ï¼Œç»§ç»­è½¬å‘çŽ°æ˜¯å¼ å›¾ç‰‡ï¼Œç„¶åŽæ‰¾äº†æ‰¾åœ¨çº¿çš„Base64è½¬PNGçš„å·¥å…·

![](img020.png)

çœ‹èµ·æ¥æ˜¯ä¸ªäºŒç»´ç ï¼Œæ‹¿æ‰‹æœºæ‰«ä¸€ä¸‹

![](img021.png)

æ‹¿åˆ°flag
> hgame{3Nc0dInG_@lL_iN_0Ne!}

åˆ°æ­¤ç»ˆäºŽæŠŠwebå’Œmiscä¸¤ä¸ªæ–¹å‘å…¨akäº†ï¼Œå­¦åˆ°äº†æŒºå¤šä¸œè¥¿ï¼Œæ„Ÿè§‰è¿˜æ˜¯ä¸é”™çš„ï¼Œä¸‹ä¸€æ­¥è¯•è¯•çœ‹çœ‹å“ªä¸ªæ–¹å‘å®¹æ˜“ç‚¹ã€‚ã€‚æ¯•ç«Ÿäººèœåªèƒ½æ¡æ¼ï¼Œä¸åƒåŒå±Šéœ¸æ¦œçš„é‚£å‡ ä½æ‰ä¸€å¤©å¤šå°±ç ´åƒäº†ï¼Œç„¶åŽèµ¶ç´§è¡¥ä¸€ä¸‹phpå’Œsqlå‡†å¤‡ä¸‹å‘¨çš„webï¼Œè‡³å°‘ä»Šæ™šå¯ä»¥å®‰å¿ƒçš„ä¼‘æ¯äº†233

---

### æ¯æ—¥æŽ¨è

é¦–å…ˆæ‹¿åˆ°çš„æ˜¯ä¸€ä¸ªåŽ‹ç¼©åŒ…ï¼Œè§£åŽ‹å¾—åˆ°WireSharkçš„æµé‡æ–‡ä»¶`Capture1.pacpng`ï¼Œç”¨WireSharkæ‰“å¼€è¿‡æ»¤httpçœ‹èƒ½ä¸èƒ½å‘çŽ°ä»€ä¹ˆ

![](img024.png)

å‘çŽ°æœ‰ä¸€æ¡æŠ¥æ–‡POSTäº†ä¸€ä¸ªåŽ‹ç¼©åŒ…ï¼Œåº”è¯¥è·Ÿflagæœ‰å…³ï¼Œè¿½è¸ªä¸‹HTTPæµçœ‹çœ‹

![](img025.png)

å‘çŽ°åŽ‹ç¼©åŒ…åç§°æ˜¯`song.zip`ï¼Œç»“åˆé¢˜ç›®ç½‘æ˜“äº‘æ¯æ—¥æŽ¨èï¼Œå¯ä»¥æ–­å®šflagåº”è¯¥å°±åœ¨è¿™é‡Œé¢

![](img026.png)

æ‰¾åˆ°å¯¹åº”çš„æŠ¥æ–‡åºå·å¹¶å¯¼å‡ºèµ„æºï¼ŒåŽç¼€æ˜¯phpï¼Œå°†å…¶æ”¹ä¸ºzipæ‰“å¼€ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªåŠ å¯†çš„mp3

![](img027.png)

æ ¹æ®å¯†ç æç¤ºä¸º6ä½æ•°å­—ï¼Œç›´æŽ¥è¿›è¡ŒAAPRçˆ†ç ´å¾—åˆ°å¯†ç ï¼Œ ç”¨å¯†ç è§£åŽ‹åŽå¾—åˆ°ä¸€ä¸ªçº¯éŸ³ä¹çš„mp3ï¼Œå¬äº†ä¸¤éä¹Ÿæ²¡å¬å‡ºä»€ä¹ˆï¼Œ ç”¨`Audacity`æŸ¥çœ‹æ³¢å½¢ï¼Œæ²¡æœ‰æ‰¾åˆ°è·Ÿæ‘©å°”æ–¯æ¯”è¾ƒåƒçš„æ³¢å½¢
è¯•ç€ç”¨`MP3Stego`è§£å¯†æ–‡ä»¶ï¼Œç”±äºŽæ²¡æœ‰å¯†ç ä¹Ÿæ²¡ä»€ä¹ˆè¿›å±•ï¼Œ `binwalk`åˆ†æžï¼Œä¹Ÿæ²¡å¾—åˆ°ä»€ä¹ˆæœ‰ä»·å€¼çš„çº¿ç´¢

ç„¶åŽGoogleéŸ³é¢‘éšå†™ç›¸å…³çš„åšå®¢å‘çŽ°äº†è¿™ä¸ª
[CTFä¸­éŸ³é¢‘éšå†™çš„ä¸€äº›æ•´ç†æ€»ç»“](https://www.sqlsec.com/2018/01/ctfwav.html)
å…¶ä¸­æåˆ°flagæœ‰å¯èƒ½æ˜¯åœ¨éŸ³é¢‘æ–‡ä»¶çš„é¢‘è°±å›¾ä¸­ï¼ŒäºŽæ˜¯`Audacity`çœ‹ä¸€ä¸‹é¢‘è°±ï¼Œæžœç„¶

![](img028.png)

æ‹¿åˆ°flag
> hgame{I_love_EDM233}

---

## Web
### Cosmosçš„åšå®¢

![](img029.png)

é¢˜ç›®å¾ˆæ˜Žæ˜¾æç¤ºäº†**ç‰ˆæœ¬ç®¡ç†å·¥å…·** ***GitHub***ï¼Œå¯ä»¥æƒ³åˆ°ç½‘é¡µæ‰€åœ¨ç›®å½•æ˜¯ä¸€ä¸ªgitä»“åº“ï¼Œç„¶åŽéšä¾¿æ‰¾äº†ä¸ªè‡ªå·±ç”µè„‘é‡Œçš„gitä»“åº“çœ‹äº†ä¸‹å†…å®¹

![](img030.png)

å‘çŽ°configæ–‡ä»¶é‡Œåº”è¯¥æœ‰éœ€è¦çš„å†…å®¹ï¼ŒäºŽæ˜¯ä¿®æ”¹URI`http://cosmos.hgame.n3ko.co/.git/config`

è®¿é—®ä¸€ä¸‹ï¼Œæžœç„¶å¾—åˆ°äº†ä¸Šæ¸¸ä»“åº“çš„ä¿¡æ¯

![](img031.png)

cloneåˆ°æœ¬åœ°ï¼Œ`git show`çœ‹ä¸€ä¸‹æäº¤ä¿¡æ¯

![](img032.png)

å‘çŽ°æ˜¯Base64

![](img033.png)
æ‹¿åˆ°flag
> hgame{g1t_le@k_1s_danger0us_!!!!}

---

### æŽ¥ å¤´ éœ¸ çŽ‹

è¿™é¢˜è™½ç„¶å› ä¸ºè‡ªå·±çœ¼çžŽå¡äº†å¥½ä¹…ï¼Œä¸è¿‡ç¡®å®žå¯¹é¦–éƒ¨å­—æ®µçš„ä½œç”¨æœ‰äº†æ›´æ·±å…¥çš„äº†è§£

é¦–å…ˆæ‰“å¼€é¢˜ç›®æ˜¯å¼ å«æœ‰æš´åŠ›è¡€è…¥å…ƒç´ çš„å›¾ç‰‡(é›¾)å’Œæç¤º

![](img034.png)

æ—¢ç„¶æ˜¯æŽ¥å¤´ï¼Œåˆæ˜¯webï¼Œé‚£åº”è¯¥å°±è·Ÿè¯·æ±‚å¤´æœ‰å…³äº†ï¼ŒäºŽæ˜¯ç”¨chromeçš„æ’ä»¶Modify HeaderåŠ äº†ä¸ª`Referer`çš„å­—æ®µ

![](img035.png)

åˆ·æ–°ä¸€ä¸‹çœ‹çœ‹ï¼Œé¡µé¢å‘ç”Ÿäº†å˜åŒ–ï¼Œçœ‹æ¥æ–¹å‘æ˜¯å¯¹çš„

![](img036.png)

ç„¶åŽç¿»äº†ç¿»ä¹‹å‰åšçš„æœ‰å…³é¦–éƒ¨å­—æ®µçš„ç¬”è®°ï¼Œçœ‹èµ·æ¥åº”è¯¥å†åŠ ä¸€ä¸ªXFFå­—æ®µ

![](img037.png)

åˆè¦æ”¹æµè§ˆå™¨åç§°ï¼Œè¿™ä¸ªç®€å•ï¼ŒåŠ ä¸ª`User-Agent`å­—æ®µå³å¯

![](img038.png)

åˆè¦ç”¨POSTæ–¹æ³•ï¼ŒäºŽæ˜¯æ‰“å¼€Postmanæ‰‹åŠ¨å‘åŒ…

![](img039.png)

çœ‹èµ·æ¥è¦ä¿®æ”¹æŸä¸ªè·Ÿæ—¶é—´æœ‰å…³çš„å­—æ®µæ‰è¡Œï¼Œè¯•äº†`Date`ã€`If-Modified-Since`ã€`Cache-Control:max-age`ç­‰å­—æ®µéƒ½æ²¡ç”¨ï¼Œç„¶åŽå…¶ä»–æ‚ä¸ƒæ‚å…«çš„æ–¹æ³•ä¹Ÿéƒ½æ˜¯äº†ä¹Ÿæ²¡ä»€ä¹ˆç”¨ï¼Œå¡äº†å¥½ä¹…ï¼ŒäºŽæ˜¯åŽšç€è„¸çš®åŽ»æ‰¾å¤§ðŸ†è¦äº†æç¤ºï¼Œè®©æˆ‘å†çœ‹çœ‹`If-Modified-Since`çš„æœ‰å…³å†…å®¹

ç„¶åŽå°±åŽ»Googleç›¸å…³ä¿¡æ¯ï¼Œåœ¨å…¶ä¸­ä¸€ç¯‡åšå®¢ä¸­å‘çŽ°äº†è¿™æ ·çš„æè¿°

![](img040.png)

å‘çŽ°`If-Modified-Since`å­—æ®µå¯¹POSTæ–¹æ³•æ˜¯æ— æ•ˆçš„ï¼Œç„¶åŽåœ¨è¿™ç¯‡åšå®¢ä¸‹é¢çš„å…¶ä»–æ–‡ç« å‘çŽ°äº†æœ‰å…³`If-Unmodified-Since`çš„æè¿°

![](img041.png)

å¯ä»¥çœ‹åˆ°è¿™ä¸ªå­—æ®µé€‚ç”¨äºŽPOSTæ–¹æ³•ï¼ŒäºŽæ˜¯åœ¨Postmané‡Œæ·»åŠ äº†è¿™ä¸€é¡¹

![](img042.png)

æ‹¿åˆ°flag
> hgame{W0w!Your_heads_@re_s0_many!}

åˆ°æ­¤ç»ˆäºŽæŠŠwebç»™akäº†ï¼Œè™½ç„¶è¿™é¢˜å¡äº†å¾ˆä¹…ï¼Œä¸è¿‡æ„Ÿè§‰æ¯é“é¢˜å¡çš„åœ°æ–¹éƒ½æ˜¯è‡ªå·±çŸ¥è¯†ç‚¹çš„æ¼æ´žï¼Œåšå®Œè¿™å››é“é¢˜ä¹Ÿç®—æ˜¯å¯¹è‡ªå·±çš„webçŸ¥è¯†æœ‰äº†ä¸€ä¸ªå¾ˆå¤§çš„è¡¥å……ï¼Œæ„Ÿè§‰è¿˜æ˜¯å¾ˆæœ‰æ”¶èŽ·çš„ï¼

---

### Code World

![](img043.png)

æ‰“å¼€å‘çŽ°403

![](img044.png)

å› ä¸º403æ˜¯æ‹’ç»è®¿é—®ï¼Œæƒ³äº†æƒ³å·²ç»æœ‰äººåšå‡ºæ¥äº†é‚£è‚¯å®šå°±æ˜¯æ•…æ„å¼„æˆè¿™æ ·çš„ï¼Œæ—¢ç„¶GETä¸äº†ï¼Œé‚£æˆ‘POSTæ€»å¯ä»¥å§ï¼ŒäºŽæ˜¯æ”¹äº†ä¸‹æ–¹æ³•é‡æ–°å‘åŒ…

![](img045.png)

äºŽæ˜¯æŠŠå‚æ•°æ”¹æˆ`a=5+5`ä¼ è¿›åŽ»ï¼Œä¸è¡Œï¼Œç„¶åŽçªç„¶å‘çŽ°å¿˜è®°urlencodeäº†ï¼ŒäºŽæ˜¯æ”¹æˆ`a=5%2b5`

![](img046.png)

æ‹¿åˆ°flag
> hgame{C0d3_1s_s0_S@_sO_C0ol!}

---

### ðŸ”ä½ å¤ªçŽ«

æ‰“å¼€é¢˜ç›®åŽæ˜¯ä¸€ä¸ªHTML5å’ŒJSå†™çš„CXKæ‰“ç¯®çƒçš„å°æ¸¸æˆ

![](img047.png)
å½“ç„¶çŽ©æ˜¯ä¸å¯èƒ½çŽ©çš„ï¼Œè‚¯å®šæ˜¯è¦ç”¨consoleä¿®æ”¹Jså˜é‡æ¥è¾¾åˆ°ç›®æ ‡ï¼Œé‚£å°±F12æ‰“å¼€consoleï¼Œç„¶åŽè¾“å…¥`dir(window)`æŸ¥çœ‹æ‰€æœ‰å¯¹è±¡

![](img048.png)

å±•å¼€åŽå‘çŽ°ä¸€ä¸ªGameç±»çš„å¯¹è±¡canvas_gï¼Œæˆå‘˜å˜é‡åæ¯”è¾ƒå¯ç–‘

![](img049.png)

è¿è¡Œä¸€ä¸‹æ¸¸æˆï¼Œæžœç„¶åˆ†æ•°å‚¨å­˜åœ¨è¿™é‡Œ

![](img050.png)

è°ƒè¯•å‡ æ¬¡åŽå‘çŽ°`storageScore`å‚¨å­˜çš„æ˜¯å½“å‰å›žåˆå¾—åˆ†ï¼Œ`globalScore`æ˜¯æ€»åˆ†ï¼ŒäºŽæ˜¯åœ¨consoleé‡Œç›´æŽ¥èµ‹å€¼

![](img051.png)

æ‹¿åˆ°flag
> hgame{j4vASc1pt_w1ll_tel1_y0u_someth1n9_u5efu1?!}

---

## Crypto

### InfantRSA

è™½ç„¶å¯†ç å­¦æ¯«æ— åŸºç¡€ï¼Œæ—¢ç„¶è¯´äº†æ˜¯çœŸÂ·ç­¾åˆ°é¢˜ï¼Œæƒ³æ¥åº”è¯¥ä¹Ÿä¸ä¼šå¤ªéš¾ï¼Œç›´æŽ¥ç»™å‡ºäº†ä¸€æ®µä»£ç 

![](img052.png)

Googleäº†ä¸€ä¸‹RSAç›¸å…³çš„ç®—æ³•ï¼Œå‘çŽ°åœ¨æ²¡æœ‰å¯†é’¥çš„æƒ…å†µä¸‹åŠ å¯†è§£å¯†åªè·Ÿ`p`ã€`q`ã€`e`æœ‰å…³ï¼Œå¹¶ä¸”æ‰¾åˆ°äº†è¿™ä¸ªåšå®¢[CTF|çŽ©è½¬RSAåŠ å¯†ç®—æ³•(ä¸€)](https://cloud.tencent.com/developer/article/1076086)ï¼Œ äºŽæ˜¯æ ¹æ®è¿™ä¸ªåšå®¢è¿˜æœ‰é¢˜ç›®æ‰€ç»™çš„éƒ¨åˆ†ä»£ç å†™äº†ä¸ªPythonè„šæœ¬ï¼Œè·‘å‡ºäº†`d`å’Œæ˜Žæ–‡`m`

![](img053.png)

å®¡è®¡ä¸€ä¸‹é¢˜ç›®æ‰€ç»™ä»£ç ï¼Œå‘çŽ°è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯å°†flag(å­—èŠ‚ç )è½¬æ¢æˆåè¿›åˆ¶ç„¶åŽè¿›è¡ŒRSAè¿ç®—å¾—åˆ°äº†å¯†ç `c`ï¼Œç„¶åŽçŽ°åœ¨å·²ç»å¾—åˆ°äº†`m`ï¼ŒæŽ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯å°†`m`è½¬æ¢æˆå­—èŠ‚ç ä¾¿èƒ½å¾—åˆ°flagäº†

æ”¹å®Œä»£ç ï¼Œè·‘ä¸€ä¸‹ï¼Œç„¶è€Œflagå¹¶æ²¡æœ‰å‡ºçŽ°

![](img054.png)

ä¸è¿‡çœ‹èµ·æ¥ä¹Ÿä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜ï¼Œæœäº†ä¸€ä¸‹æ‰¾åˆ°äº†[è§£å†³æ–¹æ¡ˆ](https://stackoverflow.com/questions/21017698/converting-int-to-bytes-in-python-3)

![](img055.png)

ä¸€é¡¿CVé¡ºåˆ©æ‹¿åˆ°flag

![](img056.png)
> hgame{t3Xt6O0k_R5A!!!}

---

### Affine

é¦–å…ˆæ‹¿åˆ°çš„æ˜¯ä¸€æ®µPythonä»£ç ï¼Œçœ‹äº†ä¸€ä¸‹å‘çŽ°å°±æ˜¯å°†flagå•å­—ç¬¦åŠ å¯†åŽç»„æˆå¯†æ–‡

![](img057.png)

é¦–å…ˆç”¨æ³¨é‡Šè¡¥å……äº†ä¸€äº›ç›¸å…³ä¿¡æ¯(`cipher`çš„å†…å®¹æ˜¯é¢˜ç›®ç»™çš„)ï¼Œæ–¹ä¾¿åˆ†æžï¼Œç„¶åŽæ³¨æ„åˆ°è·ŸåŠ å¯†æœ‰å…³çš„åº”è¯¥åªæœ‰`else`å—é‡Œçš„ä¸¤è¡Œä»£ç ï¼ŒäºŽæ˜¯æ ¹æ®å·²çŸ¥flagçš„æ ¼å¼`hgame{...}`å¯ä»¥å¾—åˆ°ä¸€æ®µæ˜Žæ–‡å’Œå¯¹åº”çš„å¯†æ–‡

> hgame <==> A8I5z

å†™è¡Œä»£ç ç®—ä¸‹ç´¢å¼•
```
print("zxcvbnmasdfghjklqwertyuiop1234567890QWERTYUIOPASDFGHJKLZXCVBNM".find(input()))
```
äºŽæ˜¯å¯ä»¥åˆ—5ä¸ªæ–¹ç¨‹æ¥æ±‚è§£æœªçŸ¥æ•°

![](img058.png)

å¾ˆå®¹æ˜“èƒ½å¤Ÿç®—å‡º`A = 13, B = 14`ï¼Œç„¶åŽå¯ä»¥å°†flagæ¯ä¸€ä½éƒ½ç”¨æš´åŠ›ç®—æ³•æ±‚å‡ºæ¥

![](img059.png)

ç¼–å†™è§£å¯†è„šæœ¬æ‹¿åˆ°flag

![](img060.png)



> hgame{M4th_u5Ed_iN_cRYpt0}

---

### not_One-time

é¦–å…ˆè¿˜æ˜¯ç»™äº†ä¸€ä¸ªåŠ å¯†è„šæœ¬ï¼Œåªä¸è¿‡æ˜¯éƒ¨ç½²åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œéœ€è¦ncæ‰èƒ½äº¤äº’

![](img061.png)

çœ‹äº†ä¸€ä¸‹ä»£ç ï¼Œå‘çŽ°æ˜¯ä¸€ä¸ªæµå¯†ç ï¼Œå³å¯¹äºŽä¸€ä¸ªæ˜Žæ–‡ï¼Œç”¨å¤šä¸ªå¯†é’¥å¯¹å…¶è¿›è¡ŒåŠ å¯†

> m ^ k1 = c1
>
> m ^ k2 = c2
>
> m ^ k3 = c3
>
> ...

å…¶ä¸­`k1`,`k2`,`k3`,`...`æ˜¯éšæœºç”Ÿæˆçš„å¯†é’¥ï¼Œé¢˜ç›®æ‰€ç»™çš„è„šæœ¬æ¯æ¬¡è¿è¡Œéƒ½ä¼šéšæœºç”Ÿæˆä¸€ä¸²èŒƒå›´ä¸ºå¤§å°å†™å­—æ¯+æ•°å­—çš„é•¿åº¦ä¸º`flag`é•¿åº¦çš„å­—ç¬¦ä¸²`keystream`ï¼Œç„¶åŽå°†å…¶ä¸Ž`flag`æŒ‰ä½å¼‚æˆ–ï¼Œä¹‹åŽå†è½¬æˆ`base64`ç¼–ç æ‰“å°å‡ºæ¥

![](img062.png)

è¿žä¸Šè¿œç«¯ï¼Œæžœç„¶è¾“å‡ºäº†ä¸€ä¸²`base64`
äºŽæ˜¯æ”¾è¿›Base64è§£ç Pythonè„šæœ¬é‡Œçœ‹ä¸€ä¸‹flagçš„é•¿åº¦

![](img063.png)

ç®—ä¸Šhgame{}ä¸€å…±æœ‰43ä¸ªå­—ç¬¦ï¼ŒæŠŠå·²çŸ¥æ¡ä»¶åˆ—ä¸€ä¸‹
> flagé•¿åº¦: 43
>
> flagèŒƒå›´: string.printable
>
> keystreamé•¿åº¦: 43
>
> keystreamèŒƒå›´: string.ascii_letters+string.digits

æƒ³åˆ°å¯ä»¥å¤šæ¬¡è®¿é—®èŽ·å–å¤šä¸ªåŠ å¯†åŽçš„åºåˆ—ï¼Œå¯¹äºŽæ¯ä¸ªåºåˆ—å°†å…¶æ¯ä¸ªå…ƒç´ éƒ½ä¸ŽflagèŒƒå›´å†…çš„æ‰€æœ‰å­—ç¬¦è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå¦‚æžœç»“æžœæ˜ å°„ASCIIåŽç¬¦åˆkeystreamçš„èŒƒå›´ï¼Œåˆ™å°†å…¶å‚¨å­˜åœ¨ä¸´æ—¶åˆ—è¡¨ä¸­ï¼Œæœ€åŽå†å¯¹æ‰€æœ‰çš„ä¸´æ—¶åˆ—è¡¨å–äº¤é›†ä»¥é™å®šèŒƒå›´ï¼Œå¤šæ¬¡è¿è¡ŒåŽä¾¿èƒ½å¾—åˆ°ä¸€ä¸ªç¨³å®šçš„flag

ç†æ¸…æ€è·¯åŽå¼€å§‹ç¼–å†™exp

![](img064.png)

å…¶ä¸­å¯¹flagé™å®šäº†128æ¬¡ï¼Œè¶³å¤Ÿå¾—åˆ°ä¸€ä¸ªç»„æˆè¾ƒä¸ºå›ºå®šçš„flagäº†

![](img065.png)

è¿è¡Œè„šæœ¬ï¼Œæ‹¿åˆ°flag
> hgame{r3us1nG+M3$5age-&&~rEduC3d_k3Y-5P4Ce}

---

### Reorder

è¿™é¢˜åˆšå¼€å§‹åªç»™äº†ä¸ªncï¼ŒäºŽæ˜¯è¿œç¨‹è¿žä¸Šéšä¾¿è¾“å…¥äº†ç‚¹ä¸œè¥¿çœ‹çœ‹

![](img066.png)

å‘çŽ°ä¼šæŠŠè¾“å…¥çš„ä¸œè¥¿éšæœºæŽ’åˆ—ï¼Œç›´æŽ¥å›žè½¦æˆ–è€…è¾“å…¥10æ¬¡åˆ™ä¼šæ‰“å°ä¸€ä¸ªä¹±åºçš„flagã€‚ç ”ç©¶äº†ä¸€ä¸‹å‘çŽ°è¿™ä¸ªåŠ å¯†çš„ç®—æ³•ä¸€æ¬¡åªåŠ å¯†16ä½ï¼Œå¦‚æžœæ˜¯32ä½çš„è¯åˆ™åˆ†æˆä¸¤ä¸ª16ä½çš„å­—ç¬¦ä¸²åˆ†å¼€åŠ å¯†ç„¶åŽå†åˆå¹¶

![](img067.png)

ç„¶åŽçœ‹äº†çœ‹flagçš„é•¿åº¦ï¼Œæ­£å¥½æ˜¯32ä½ï¼ŒäºŽæ˜¯æŠŠ16è¿›åˆ¶çš„å­—ç¬¦è¾“è¿›åŽ»ï¼Œå°†æ˜Žæ–‡ä¸Žå¯†æ–‡è¿›è¡Œå¯¹æ¯”ï¼Œå‘çŽ°flagä¹Ÿæ˜¯æŒ‰ç…§è¿™æ ·çš„é¡ºåºæŽ’åˆ—çš„

![](img068.png)

äºŽæ˜¯å†™äº†ä¸ªèƒ½æ ¹æ®å·²çŸ¥çš„æ˜Žæ–‡å’Œå¯†æ–‡ç®—å‡ºflagçš„exp

![](img069.png)

è¿è¡Œä¸€ä¸‹ï¼Œæ‹¿åˆ°flag
> hgame{jU$t+5ImpL3_PeRmuTATi0n!!}

---

## Reverse

### maze

å—¯ã€‚ã€‚ç¬¬ä¸€æ¬¡åšReæ–¹å‘çš„é¢˜ï¼Œåªæœ‰ä¸€ç‚¹æ±‡ç¼–åŸºç¡€ï¼Œä¸è¿‡è¿˜å¥½å­¦é•¿ç»™äº†å¾ˆå¤šå­¦ä¹ èµ„æ–™ï¼Œé¦–å…ˆçœ‹äº†å…³äºŽmazeçš„ä»‹ç»ï¼Œå¤§æ¦‚æ˜Žç™½äº†è§£é¢˜æ€è·¯å°±æ˜¯é€šè¿‡é€†å‘åˆ†æžç¨‹åºæ‰¾åˆ°ç”±é™å®šå­—ç¬¦ç»„æˆçš„"è¡Œè¿›æ–¹å¼"åœ¨é¢„è®¾çš„è¿·å®«å†…æ‰¾åˆ°è·¯çº¿ï¼Œè¾“å…¥è¡Œè¿›è·¯çº¿å­—ç¬¦ä¸²å³å¯é€šè¿‡è¿·å®«

æ‹¿åˆ°æ–‡ä»¶åŽé¦–å…ˆchecksecäº†ä¸‹å‘çŽ°æ˜¯ELFï¼ŒäºŽæ˜¯ç”¨wslæ‰“å¼€

![](img070.png)

ç¬¬ä¸€æ¬¡è§åˆ°è¿™ç§æ–‡å­—å›¾ï¼Œæœ‰ç‚¹è¢«æƒŠè‰³åˆ°ï¼Œéšæ„æ‰“äº†å‡ ä¸ªå­—è¿›åŽ»ï¼Œ
ç»“æžœæç¤º`You died`ï¼Œçœ‹èµ·æ¥è¦æŠŠè·¯å¾„å­—ç¬¦ä¸²è¾“å…¥åˆ°è¿™é‡Œï¼ŒäºŽæ˜¯æ‰“å¼€IDAæ‹–è¿›åŽ»F5æŸ¥çœ‹æºç 

![](img071.png)

å—¯ï¼Œå¤§è‡´çœ‹äº†ä¸‹ï¼Œè¡Œè¿›çš„å•ä½åº”è¯¥æ˜¯ä¸€ä¸ª`(char*)`ç±»åž‹çš„å˜é‡`v6`ï¼Œç„¶åŽæ ¹æ®ä»£ç åˆ—äº†ä¸€ä¸ªæ˜ å°„è¡¨
> w ==> -64
>
> s ==>  64
>
> a ==> -4
>
> d ==>  4

ç„¶åŽçœ‹åˆ°äº†ä¸€æ®µè·Ÿflagæœ‰å…³çš„ä»£ç 

![](img072.png)

![](img073.png)

æºä»£ç é‡ŒæŠŠ`v6`åˆå§‹åŒ–ä¸º`0x6020C4`äº†ï¼Œç®€å•ç®—äº†ä¸€ä¸‹
> 0x60243C - 0x6020C4 = 888 = 64 * 14 - 4 * 2
>
çœ‹èµ·æ¥å¥½åƒåªè¦è®©`v6`ç­‰äºŽ`0x60243C`å°±å¯ä»¥äº†ï¼Œç„¶åŽä¸Šé¢çš„ifè¯­å¥ç»™`v6`åŠ äº†ä¸€ä¸ªé™åˆ¶èŒƒå›´ï¼Œä¸è¿‡åˆšå¼€å§‹ç¬¬ä¸‰ä¸ªæ¡ä»¶æ²¡æ€Žä¹ˆçœ‹æ‡‚ï¼ŒäºŽæ˜¯çœ‹äº†ä¸‹ç¬¬ä¸‰ä¸ªæ¡ä»¶çš„æ±‡ç¼–ä»£ç 

![](img074.png)

å‘çŽ°ä½œç”¨æ˜¯å°†`v6`æ”¾å…¥`RAX`å¹¶ä¸”æŠŠ`RAX`æŒ‡å‘çš„å†…å­˜ç©ºé—´çš„å€¼èµ‹å€¼ç»™`EAX`ï¼Œç„¶åŽä¸Ž1è¿›è¡Œä¸Žè¿ç®—å¹¶æŠŠç»“æžœæ”¾å…¥`EAX`ï¼Œä¹‹åŽå†è‡ªèº«è¿›è¡Œä¸Žè¿ç®—ï¼Œå¦‚æžœEAXç­‰äºŽ1åˆ™è·³è½¬åˆ°`loc_4008C6`å¤„ï¼Œä¹Ÿå°±æ˜¯`You died`ã€‚ ç„¶åŽå‘çŽ°ä»Ž`v6`çš„åˆå§‹å€¼`0x6020C4`å¼€å§‹æ˜¯ä¸€æ®µ0å’Œ1çš„åºåˆ—

![](img075.png)

çœ‹æ¥è¿™ä¸ªå°±æ˜¯è¿·å®«ï¼Œå‰é¢ç®—å‡ºçš„`888`æ˜¯è·¯å¾„é•¿åº¦ï¼ŒäºŽæ˜¯æŠŠè¿™æ®µæ•°æ®å¤åˆ¶å‡ºæ¥å•ç‹¬åˆ†æž

ä¸€å¼€å§‹æƒ³çš„æ˜¯æ‰‹åŠ¨å¯»è·¯ï¼Œä½†æ˜¯æ‹¿è®¡ç®—å™¨ç®—äº†ä¸€ä¼šå‘çŽ°ä¸å¤ªè¡Œï¼ŒäºŽæ˜¯æƒ³å†™ä¸ªPythonè„šæœ¬è‡ªåŠ¨å¯»è·¯
æ€è·¯æ˜¯å…ˆè¯»å…¥å­—æ®µå¹¶æ ¼å¼åŒ–æˆä¸€ä¸ªç±»ä¼¼æŒ‡é’ˆçš„å­—å…¸ï¼Œ`[Address]=0/1`ï¼Œç„¶åŽæ ¹æ®å­—å…¸çš„é”®å€¼(0/1)åˆ¤æ–­æ˜¯é€šè·¯è¿˜æ˜¯å µè·¯ï¼Œä½†æ˜¯ç”±äºŽè¿˜æ²¡å­¦è¿‡DFSï¼Œå†™å‡ºçš„ç®—æ³•ç›´æŽ¥çˆ†æ ˆäº†ï¼ŒäºŽæ˜¯åªå¥½ç²¾ç®€ä»£ç ï¼Œæ‰‹åŠ¨å¯»è·¯ï¼Œä½†æ˜¯ç”±Pythonæ¥å¸®æˆ‘è®¡ç®—æ˜¯å¦èƒ½å¤Ÿé€šè¡Œï¼Œæˆ‘åªéœ€è¦è¾“å…¥wasdå°±å¯ä»¥äº†ï¼Œè™½ç„¶è¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦ä½†æ˜¯æ¯”æ‹¿è®¡ç®—å™¨ä¸€ä¸ªä¸€ä¸ªç®—è¿˜æ˜¯å¿«å¤šäº†

![](img076.png)

äºŽæ˜¯å°±åƒè¿™æ ·ä¸€æ­¥ä¸€æ­¥çš„æ‘¸ç´¢

![](img077.png)

åŒæ—¶åœ¨çº¸ä¸Šä¹Ÿç”»äº†æ¡è·¯å‡ºæ¥

![](img078.jpg)

ä¸è¿‡å°‘ç”»äº†ä¸€æ­¥ï¼ŒåŽæ¥æ‰å‘çŽ°æ·»ä¸ŠåŽ»äº†
ç„¶åŽæ ¹æ®ç”»å‡ºæ¥çš„è·¯å¾„å›¾åˆé‡æ–°èµ°äº†ä¸€éå…¨0çš„è·¯çº¿ï¼Œå¾—åˆ°è·¯å¾„å­—ç¬¦ä¸²`ssssddddddsssssddwwdddssssdssdd`

![](img079.png)

æ‹¿åˆ°flag
> hgame{ssssddddddsssssddwwdddssssdssdd}


---

### bitwise_operation2

æ‹¿åˆ°çš„ä¾ç„¶æ˜¯ä¸€ä¸ªELFæ–‡ä»¶ï¼Œæ‹–è¿›IDAç„¶åŽF5

![](img080.png)

å¯ä»¥çœ‹åˆ°æœ‰å¤§é‡çš„ä½è¿ç®—å’Œå¼‚æˆ–è¿ç®—
äºŽæ˜¯æ‰“ç®—é‡æž„ä¸€ä¸‹ä»£ç ï¼Œå…ˆä»Žæœ€ä¸Šé¢çš„ifå¼€å§‹

![](img081.png)

ç„¶åŽæ³¨æ„åˆ°ä¸­é—´æœ‰ä¸¤è¡Œå¥‡æ€ªçš„å‡½æ•°

![](img082.png)

ç‚¹è¿›åŽ»çœ‹äº†ä¸‹

![](img083.png)

çœ‹èµ·æ¥åº”è¯¥æ˜¯å¯¹è¾“å…¥çš„ä¸¤ä¸ªå‚æ•°è¿›è¡Œäº†ä¸€äº›å¤„ç†ï¼ŒäºŽæ˜¯é‡æž„ä¸€ä¸‹

![](img084.png)

è§‚å¯Ÿifè¯­å¥å¯ä»¥çœ‹å‡ºå¯¹`str2`æœ‰ä¸€äº›é™åˆ¶æ¡ä»¶ï¼Œå…¶åªèƒ½æ˜¯å°å†™çš„16è¿›åˆ¶å­—ç¬¦ï¼Œç„¶åŽå°†å…¶è½¬æ¢æˆåè¿›åˆ¶å¹¶é€šè¿‡ä¸€äº›è¿ç®—èµ‹å€¼ç»™`str1`ï¼Œç„¶åŽæ ¹æ®åŸºå€åç§»é‡æž„äº†ä¸€ä¸‹æ•°æ®ç±»åž‹ï¼Œå…¶ä¸­flagå†…å®¹ç”±ä¸¤ä¸ª16å­—èŠ‚çš„å­—ç¬¦ä¸²`flag_part1`ã€`flag_part2`ç»„æˆï¼Œå…¶ç»è¿‡å‡½æ•°è¿ç®—åŽèµ‹ç»™`part1`å’Œ`part2`ï¼Œç„¶åŽå¯¹`part1`å’Œ`part2`è¿›è¡Œæ“ä½œ

![](img085.png)

![](img086.png)

é‡æž„ä½+å¼‚æˆ–è¿ç®—éƒ¨åˆ†å¹¶è§£é‡Šï¼Œå¹¶ä¸”å°†ä¹‹å‰é‚£ä¸ªå‡½æ•°çš„åŠŸèƒ½ç”¨Pythonè¯­æ³•æ³¨é‡Šäº†ä¸€ä¸‹

![](img087.png)

è§‚å¯Ÿå¼‚æˆ–è¿ç®—éƒ¨åˆ†

![](img088.png)

![](img089.png)
![](img090.png)

ç„¶åŽå‘çŽ°ä¸Šé¢è¿™éƒ¨åˆ†æœ‰ä¸¤ä¸ªbyteæŒ‡é’ˆï¼Œç„¶åŽç‚¹è¿›åŽ»å‘çŽ°æ˜¯ä¸¤ä¸ª8å­—èŠ‚çš„å­—ç¬¦ä¸²é¢é‡ï¼ŒäºŽæ˜¯ç»§ç»­é‡æž„

![](img091.png)

å¯ä»¥çœ‹åˆ°`part1`å’Œ`part2`åœ¨ç»è¿‡ä¸€ç³»åˆ—çš„è¿ç®—ä¹‹åŽä¸Ž`str1`ã€`str2`ç›¸ç­‰æ‰èƒ½å¾—åˆ°flag

çŽ°åœ¨æ•´ä¸ªæºä»£ç å·²ç»é‡æž„å®Œæ¯•ï¼Œç”±äºŽæœ€åŽè¦è·Ÿ`str1`å’Œ`str2`è¿›è¡Œæ¯”è¾ƒï¼Œæ‰€ä»¥ä»Žå¼‚æˆ–éƒ¨åˆ†å¼€å§‹åæŽ¨ï¼Œæ ¹æ®ä¸‹é¢çš„å…¬å¼

> a ^ b = c
>
> a = b ^ c

å¯çŸ¥æ¶‰åŠåˆ°ä¸‰ä¸ªæ•°çš„å¼‚æˆ–è¿ç®—ï¼Œåªè¦çŸ¥é“å…¶ä¸­ä¸¤ä¸ªä¾¿èƒ½æ±‚å¾—ç¬¬ä¸‰ä¸ªï¼Œç„¶åŽè§‚å¯Ÿä¸Šé¢ä¸¤ä¸ªå¼‚æˆ–è¿ç®—ï¼Œå½“ç­‰å¼æˆç«‹æ—¶å˜æ¢å½¢å¼å¯ä»¥å¾—åˆ°

> part1 = part1 ^ key = str1
>
> part2 = part2 ^ (part1 ^ key) = str2

ç”±äºŽç¬¬ä¸€è¡Œæ”¹å˜äº†part1çš„å€¼ï¼Œæ‰€ä»¥è¦å…ˆä»Žç¬¬äºŒè¡Œå¼€å§‹é€†è¿ç®—

> part2 = str2 ^ (part1 ^ key)
>
> part1 = str1 ^ key

äºŽæ˜¯è¿™æ ·å°±å¯ä»¥è¿˜åŽŸå‡ºå¼‚æˆ–è¿ç®—ä¹‹å‰çš„`part1`å’Œ`part2`äº†ï¼Œç„¶åŽå¼€å§‹é€†æŽ¨ä¸Šé¢çš„ä½+å¼‚æˆ–è¿ç®—

è§‚å¯Ÿå…¶çš„ç»“æž„å¯çŸ¥ï¼Œé™¤äº†ç¬¬ä¸€è¡Œå¤–ï¼Œå‰©ä½™ä¸‰è¡Œå‡å¯ç”¨ä¸‹é¢çš„å½¢å¼è¡¨ç¤º

> a = b ^ a

ç„¶åŽå¯ä»¥å¾—åˆ°ä¸‹é¢çš„å¼å­

> a(new) = b ^ a(old)
>
> a(old) = b ^ a(new)

æ‰€ä»¥è¦æƒ³é€†æŽ¨ï¼Œåªéœ€è¦ä»Žä¸‹å¾€ä¸Šå†æ‰§è¡Œä¸€æ¬¡ä¸Šé¢çš„ä»£ç å³å¯ï¼Œç„¶åŽå†å°†012ä½å’Œ34567ä½è¿›è¡Œäº¤æ¢å³å¯å¾—åˆ°åŽŸå§‹çš„`part1`å’Œ`part2`çš„å€¼

ç†æ¸…æ€è·¯åŽå¼€å§‹ç¼–å†™è§£å¯†ç¨‹åº

![](img092.png)

ç¼–è¯‘è¿è¡Œï¼Œå¾—åˆ°`part1`å’Œ`part2`çš„å€¼

![](img093.png)

ç„¶åŽå¼€å§‹é€†æŽ¨æœ€å¼€å§‹çš„funcå‡½æ•°ï¼Œç”±äºŽå·²ç»ç”¨Pythonæè¿°å…¶åŠŸèƒ½äº†ï¼Œé‚£å°±ç›´æŽ¥ç”¨Pythonå°†æ¯ä¸€ä½çˆ†ç ´å‡ºæ¥

![](img094.png)

å°†è§£å¯†ç¨‹åºæ‰€å¾—åˆ°çš„`part1`å’Œ`part2`çš„å€¼å¡«è¿›åŽ»çˆ†ç ´

![](img095.png)

æ‹¿åˆ°flag
> hgame{0f233e63637982d266cbf41ecb1b0102}

è¿™é“é¢˜è™½ç„¶é‡æž„ä»£ç èŠ±äº†å¥½ä¹…ï¼Œä¸è¿‡å¯¹IDAçš„åç¼–è¯‘ä»£ç æ ¼å¼å’Œæ•°æ®ç±»åž‹çš„åº•å±‚åˆæœ‰äº†æ›´æ·±çš„ç†è§£ï¼Œè€Œä¸”è¿˜æ‹¿åˆ°äº†150åˆ†ï¼Œä¹Ÿç®—æ˜¯æ”¶èŽ·é¢‡ä¸°

---

### advance

è¿™æ¬¡æ‹¿åˆ°çš„æ˜¯ä¸€ä¸ªexeï¼ŒäºŽæ˜¯ç›´æŽ¥æ‰“å¼€çœ‹çœ‹

![](img096.png)

çœ‹æ¥åˆæ˜¯ä¸€ä¸ªç›´æŽ¥å°†flagåŠ å¯†çš„ç¨‹åºï¼Œæ‹–è¿›IDAç„¶åŽF5

![](img097.png)

é‡æž„ä¸€ä¸‹

![](img098.png)

å¯ä»¥çœ‹åˆ°ç¨‹åºçš„ä½œç”¨æ˜¯å°†è¾“å…¥çš„`flag`é€šè¿‡`encode`å‡½æ•°è½¬åŒ–æˆå­—ç¬¦ä¸²`str`å¹¶ä¸Ž`"0g371wvVy9qPztz7xQ+PxNuKxQv74B/5n/zwuPfX"`æ¯”è¾ƒï¼Œä½†æ˜¯è¿™ä¸ªå­—ç¬¦ä¸²çœ‹èµ·æ¥æœ‰ç‚¹åƒbase64ç¼–ç ï¼ŒäºŽæ˜¯é‡æž„ä¸€ä¸‹`encode`å‡½æ•°

![](img099.png)

å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªæ¢è¡¨Base64è½¬ç ï¼ŒäºŽæ˜¯åœ¨ç½‘ä¸Šæ‰¾äº†ä¸€ä¸ªæ¢è¡¨çš„Base64è§£ç è„šæœ¬

![](img100.png)

ä¿®æ”¹ä¸€ä¸‹ç„¶åŽè¿è¡Œ

![](img101.png)

æ‹¿åˆ°flag
> hgame{b45e6a_i5_50_eazy_6VVSQ}

---

## Pwn

### Hard_AAAAA

é¦–å…ˆæ‹¿åˆ°çš„æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œchecksecçœ‹äº†ä¸€ä¸‹å‘çŽ°æ˜¯ä¸€ä¸ª32ä½çš„ELFæ–‡ä»¶è€Œä¸”å¼€äº†æ ˆä¿æŠ¤ï¼Œç”±äºŽwslä¸æ”¯æŒè¿™ä¸ªæ ¼å¼ï¼Œæ‰€ä»¥ç”¨äº†ubuntuçŽ¯å¢ƒæ¥è°ƒè¯•

![](img102.png)

æ‹–è¿›IDAçœ‹ä¸€ä¸‹æœºå™¨ç ï¼Œå‘çŽ°æœ‰ä¸€ä¸ª`backdoor`å‡½æ•°ï¼Œç”±äºŽå¼€äº†æ ˆä¿æŠ¤ï¼Œæ‰€ä»¥è™½ç„¶æœ‰`gets`å‡½æ•°ä½†æ˜¯ç”¨æº¢å‡ºè¦†ç›–è¿”å›žå€¼çš„æ–¹æ³•æ˜¯è¡Œä¸é€šçš„ï¼ŒäºŽæ˜¯ç»§ç»­å¾€ä¸‹çœ‹å‘çŽ°æœ‰ä¸€ä¸ª`memcmp`å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¿”å›žæ¯”è¾ƒç»“æžœï¼Œè€Œè¿”å›žç»“æžœé»˜è®¤å‚¨å­˜åœ¨å¯„å­˜å™¨`EAX`ä¸­ï¼Œä¸‹é¢çš„`test`å¯¹`EAX`è¿›è¡Œäº†åˆ¤æ–­ï¼Œå¦‚æžœä¸º0åˆ™è·³è½¬åˆ°`backdoor`å‡½æ•°ã€‚äºŽæ˜¯æ‰“å¼€gdbï¼Œåœ¨`gets`å’Œ`memcmp`å‡½æ•°å¤„ä¸‹æ–­ç‚¹çœ‹ä¸€ä¸‹ä¼ å…¥å‚æ•°çš„åœ°å€

![](img103.png)

çœ‹èµ·æ¥`gets`è¯»å…¥çš„å†…å®¹å‚¨å­˜åœ¨`0xffffd0cc`ä¸­ã€‚ IDAé‡Œå¯ä»¥çœ‹åˆ°`memcmp`å‡½æ•°çš„ä¸‰ä¸ªå‚æ•°åˆ†åˆ«æ˜¯(`"0O0o"`,`0xffffd0cc+0x7b`,7), ç¬¬äºŒä¸ªå‚æ•°é‡Œè¿›è¡Œäº†å†…å­˜åç§»ï¼Œæ‰€ä»¥æ¯”è¾ƒçš„å®žé™…æ˜¯"0O0o"å’Œgetsè¯»å…¥å­—ç¬¦ä¸²çš„123ä½å¼€å§‹å¾€åŽ7ä½

![](img104.png)

è¾“å…¥äº†123ä¸ª`a`å†åŠ ä¸Š`0O0o`è¿›åŽ»ï¼Œç„¶åŽè·³åˆ°ä¸‹ä¸ªæ–­ç‚¹ï¼Œå¯ä»¥çœ‹åˆ°ä¼ å…¥çš„å‚æ•°æ­£æ˜¯`0xffffd0cc`åç§»äº†`0x7b`çš„åœ°å€

ä½†æ˜¯æ¯”è¾ƒå®Œå‘çŽ°ä¸€ä¸ªå¥‡æ€ªçš„äº‹ï¼Œ`EAX`å¹¶ä¸æ˜¯é¢„æœŸçš„0

![](img105.png)

ç„¶åŽæƒ³åˆ°æ¯”è¾ƒäº†7ä½ä½†æ˜¯ä¼ å…¥çš„ä¸¤ä¸ªå‚æ•°åªæœ‰4ä½ï¼ŒäºŽæ˜¯çœ‹äº†ä¸‹å¾€åŽ8ä½çš„åœ°å€çš„å†…å®¹

![](img106.png)

å¯ä»¥çœ‹åˆ°`0x80486e0`ç¬¬äº”ä½æ˜¯`0x00`,ä½†æ˜¯ç¬¬å…­ä½å’Œç¬¬ä¸ƒä½è¿˜æœ‰æ•°æ®ï¼Œä½†è¾“å…¥çš„å­—ç¬¦ä¸²å´æ˜¯éƒ½æ˜¯0ï¼Œå¯¼è‡´è¿”å›žç»“æžœ`EAX`çš„å€¼éž0
çœ‹äº†ä¸‹åŽé¢çš„å†…å®¹

![](img107.png)
è¯´æ˜Žæ¯”è¾ƒçš„7ä½é‡ŒåŒ…å«äº†ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œä½†æ˜¯`gets`ç”¨é”®ç›˜è¾“å…¥çš„æ–¹å¼å¹¶ä¸èƒ½åœ¨å­—ç¬¦ä¸²ä¸­é—´æ’å…¥`'\0'`ï¼Œä¸è¿‡è¿˜å¥½Pythonçš„`pwntools`å¯ä»¥å¯¹ncç›´æŽ¥ä¼ è¾“æ•°æ®ï¼Œå°±å¯ä»¥ä¼ è¾“'\0'è¿‡åŽ»äº†

ç¼–å†™exp

![](img108.png)

Pwn!çš„ä¸€å£°çš„æ•²ä¸‹å›žè½¦å°±ç›´æŽ¥æ‹¿åˆ°shell(è™½ç„¶å‰é¢åˆ†æžäº†å¥½ä¹…ï¼Œä¸è¿‡è¿™ä¸€ä¸‹è¿˜æ˜¯æŒºçˆ½çš„233)

![](img109.png)

æ‹¿åˆ°flag

> hgame{0OoO0oo0O0Oo}

---

### One_Shot

æ‹¿åˆ°çš„ä¾æ—§æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œchecksecçœ‹äº†ä¸‹å‘çŽ°æ²¡æœ‰å†…å­˜æº¢å‡ºä¿æŠ¤ï¼Œï¼ŒäºŽæ˜¯æƒ³åˆ°è¿™é¢˜åº”è¯¥è¦è¦†ç›–å†…å­˜æ¥æ‹¿åˆ°flag

ç›´æŽ¥æ‹–è¿›IDAï¼Œç„¶åŽF5çœ‹æºç 

![](img110.png)

å‘çŽ°æ˜¯å°†flagæ–‡ä»¶è¯»å…¥åˆ°å˜é‡`flag`ä¸­ï¼Œç„¶åŽè¯»ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯»ä¸€ä¸ªæŒ‡é’ˆï¼Œç„¶åŽæŠŠè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å†…å®¹æ”¹ä¸º1ï¼Œçœ‹æ¥è¦æ‰¾ä¸€ä¸ªåˆæ³•çš„èƒ½è¯»å†™çš„åœ°å€

çœ‹ä¸€ä¸‹é™æ€å†…å­˜åˆ†å¸ƒ

![](img111.png)

å‘çŽ°è¯»å…¥çš„`name`å’Œæ–‡ä»¶æŒ‡é’ˆ`fd`æ˜¯ç›¸è¿žçš„ï¼Œé‚£åªè¦è¦†ç›–è¿™ä¸ªæ–‡ä»¶æŒ‡é’ˆçš„å†…å®¹ä¾¿èƒ½å°†flagè¿žç€ä¸€å—æ‰“å°å‡ºæ¥ï¼Œç„¶åŽåœ¨æœ¬åœ°ç”Ÿæˆäº†ä¸€ä¸ªæµ‹è¯•ç”¨çš„flagæ–‡ä»¶ï¼Œç„¶åŽåå­—è¾“å…¥32ä¸ªaï¼ŒæŒ‡é’ˆå°±æ‰¾ä¸€ä¸ªåˆæ³•åœ°å€ï¼Œä¾¿å–äº†`name`çš„é¦–åœ°å€`0x006010c0`

![](img112.png)

ä½†æ˜¯é¢„æœŸçš„flagå¹¶æ²¡æœ‰å‡ºçŽ°ï¼ŒäºŽæ˜¯è€ƒè™‘åˆ°å˜é‡`flag`çš„é¦–åœ°å€çš„å†…å®¹å¯èƒ½æ˜¯`\0`ï¼Œæ‰€ä»¥ç¨‹åºè¯†åˆ«æˆå­—ç¬¦ä¸²ç»“å°¾ï¼Œç„¶åŽæºä»£ç é‡Œåˆšå¥½å¯ä»¥è®©æŒ‡é’ˆæŒ‡å‘çš„å€¼æ”¹ä¸º1ï¼ŒäºŽæ˜¯è¾“å…¥`flag`çš„é¦–åœ°å€`0x006010e0`è¯•è¯•

![](img113.png)

æžœç„¶æŠŠæµ‹è¯•flagæ‰“å°å‡ºæ¥äº†

![](img114.png)

ç„¶åŽå†™expç›´æŽ¥è¿œç¨‹äº¤äº’

![](img115.png)

æ‹¿åˆ°ä¸€ä¸ªæ®‹ç¼ºçš„flagï¼Œä¿®å¤ä¸€ä¸‹å³å¯

> hgame{On3_Sh0t_0ne_Fl4g}